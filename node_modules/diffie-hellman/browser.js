var generatePrime = require('./lib/generatePrime')
var primes = require('./lib/primes.json')

var DH = require('./lib/dh')

function getDiffieHellman (mod) ***REMOVED***
  var prime = new Buffer(primes[mod].prime, 'hex')
  var gen = new Buffer(primes[mod].gen, 'hex')

  return new DH(prime, gen)
***REMOVED***

var ENCODINGS = ***REMOVED***
  'binary': true, 'hex': true, 'base64': true
***REMOVED***

function createDiffieHellman (prime, enc, generator, genc) ***REMOVED***
  if (Buffer.isBuffer(enc) || ENCODINGS[enc] === undefined) ***REMOVED***
    return createDiffieHellman(prime, 'binary', enc, generator)
  ***REMOVED***

  enc = enc || 'binary'
  genc = genc || 'binary'
  generator = generator || new Buffer([2])

  if (!Buffer.isBuffer(generator)) ***REMOVED***
    generator = new Buffer(generator, genc)
  ***REMOVED***

  if (typeof prime === 'number') ***REMOVED***
    return new DH(generatePrime(prime, generator), generator, true)
  ***REMOVED***

  if (!Buffer.isBuffer(prime)) ***REMOVED***
    prime = new Buffer(prime, enc)
  ***REMOVED***

  return new DH(prime, generator, true)
***REMOVED***

exports.DiffieHellmanGroup = exports.createDiffieHellmanGroup = exports.getDiffieHellman = getDiffieHellman
exports.createDiffieHellman = exports.DiffieHellman = createDiffieHellman
