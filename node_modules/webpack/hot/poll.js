/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
/*globals __resourceQuery */
if(module.hot) ***REMOVED***
	var hotPollInterval = +(__resourceQuery.substr(1)) || (10 * 60 * 1000);
	var log = require("./log");

	var checkForUpdate = function checkForUpdate(fromUpdate) ***REMOVED***
		if(module.hot.status() === "idle") ***REMOVED***
			module.hot.check(true).then(function(updatedModules) ***REMOVED***
				if(!updatedModules) ***REMOVED***
					if(fromUpdate) log("info", "[HMR] Update applied.");
					return;
				***REMOVED***
				require("./log-apply-result")(updatedModules, updatedModules);
				checkForUpdate(true);
			***REMOVED***).catch(function(err) ***REMOVED***
				var status = module.hot.status();
				if(["abort", "fail"].indexOf(status) >= 0) ***REMOVED***
					log("warning", "[HMR] Cannot apply update.");
					log("warning", "[HMR] " + err.stack || err.message);
					log("warning", "[HMR] You need to restart the application!");
				***REMOVED*** else ***REMOVED***
					log("warning", "[HMR] Update failed: " + err.stack || err.message);
				***REMOVED***
			***REMOVED***);
		***REMOVED***
	***REMOVED***;
	setInterval(checkForUpdate, hotPollInterval);
***REMOVED*** else ***REMOVED***
	throw new Error("[HMR] Hot Module Replacement is disabled.");
***REMOVED***
