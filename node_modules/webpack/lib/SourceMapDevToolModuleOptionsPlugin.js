/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
"use strict";

const ModuleFilenameHelpers = require("./ModuleFilenameHelpers");

class SourceMapDevToolModuleOptionsPlugin ***REMOVED***
	constructor(options) ***REMOVED***
		this.options = options;
	***REMOVED***

	apply(compilation) ***REMOVED***
		const options = this.options;
		if(options.module !== false) ***REMOVED***
			compilation.plugin("build-module", module => ***REMOVED***
				module.useSourceMap = true;
			***REMOVED***);
		***REMOVED***
		if(options.lineToLine === true) ***REMOVED***
			compilation.plugin("build-module", module => ***REMOVED***
				module.lineToLine = true;
			***REMOVED***);
		***REMOVED*** else if(options.lineToLine) ***REMOVED***
			compilation.plugin("build-module", module => ***REMOVED***
				if(!module.resource) return;
				let resourcePath = module.resource;
				const idx = resourcePath.indexOf("?");
				if(idx >= 0) resourcePath = resourcePath.substr(0, idx);
				module.lineToLine = ModuleFilenameHelpers.matchObject(options.lineToLine, resourcePath);
			***REMOVED***);
		***REMOVED***
	***REMOVED***
***REMOVED***

module.exports = SourceMapDevToolModuleOptionsPlugin;
