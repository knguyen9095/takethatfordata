/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
"use strict";
const NullDependency = require("./NullDependency");

class HarmonyExportSpecifierDependency extends NullDependency ***REMOVED***
	constructor(originModule, id, name, position, immutable) ***REMOVED***
		super();
		this.originModule = originModule;
		this.id = id;
		this.name = name;
		this.position = position;
		this.immutable = immutable;
	***REMOVED***

	get type() ***REMOVED***
		return "harmony export specifier";
	***REMOVED***

	getExports() ***REMOVED***
		return ***REMOVED***
			exports: [this.name]
		***REMOVED***;
	***REMOVED***
***REMOVED***

HarmonyExportSpecifierDependency.Template = class HarmonyExportSpecifierDependencyTemplate ***REMOVED***
	apply(dep, source) ***REMOVED***
		const content = this.getPrefix(dep) + this.getContent(dep);
		source.insert(dep.position, content);
	***REMOVED***

	getPrefix(dep) ***REMOVED***
		return dep.position > 0 ? "\n" : "";
	***REMOVED***

	getContent(dep) ***REMOVED***
		const used = dep.originModule.isUsed(dep.name);
		if(!used) ***REMOVED***
			return `/* unused harmony export $***REMOVED***(dep.name || "namespace")***REMOVED*** */\n`;
		***REMOVED***

		const exportsName = dep.originModule.exportsArgument || "exports";
		if(dep.immutable) ***REMOVED***
			return `/* harmony export (immutable) */ $***REMOVED***exportsName***REMOVED***[$***REMOVED***JSON.stringify(used)***REMOVED***] = $***REMOVED***dep.id***REMOVED***;\n`;
		***REMOVED***

		return `/* harmony export (binding) */ __webpack_require__.d($***REMOVED***exportsName***REMOVED***, $***REMOVED***JSON.stringify(used)***REMOVED***, function() ***REMOVED*** return $***REMOVED***dep.id***REMOVED***; ***REMOVED***);\n`;
	***REMOVED***
***REMOVED***;

module.exports = HarmonyExportSpecifierDependency;
