/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
"use strict";

const DepBlockHelpers = exports;

DepBlockHelpers.getLoadDepBlockWrapper = (depBlock, outputOptions, requestShortener, name) => ***REMOVED***
	const promiseCode = DepBlockHelpers.getDepBlockPromise(depBlock, outputOptions, requestShortener, name);
	return [
		promiseCode + ".then(",
		").catch(",
		")"
	];
***REMOVED***;

DepBlockHelpers.getDepBlockPromise = (depBlock, outputOptions, requestShortener, name) => ***REMOVED***
	if(depBlock.chunks) ***REMOVED***
		const chunks = depBlock.chunks.filter(chunk => !chunk.hasRuntime() && chunk.id !== null);
		const pathChunkCheck = outputOptions.pathinfo && depBlock.chunkName;
		const shortChunkName = requestShortener.shorten(depBlock.chunkName);
		const chunkReason = asComment(depBlock.chunkReason);
		const requireChunkId = chunk => "__webpack_require__.e(" + JSON.stringify(chunk.id) + ")";
		name = asComment(name);
		if(chunks.length === 1) ***REMOVED***
			const chunkId = JSON.stringify(chunks[0].id);
			return `__webpack_require__.e$***REMOVED***name***REMOVED***($***REMOVED***chunkId***REMOVED***$***REMOVED***pathChunkCheck ? "/*! " + shortChunkName + " */" : ""***REMOVED***$***REMOVED***chunkReason***REMOVED***)`;
		***REMOVED*** else if(chunks.length > 0) ***REMOVED***
			return `Promise.all$***REMOVED***name***REMOVED***($***REMOVED***pathChunkCheck ? "/*! " + shortChunkName + " */" : ""***REMOVED***[$***REMOVED***chunks.map(requireChunkId).join(", ")***REMOVED***])`;
		***REMOVED***
	***REMOVED***
	return "new Promise(function(resolve) ***REMOVED*** resolve(); ***REMOVED***)";
***REMOVED***;

function asComment(str) ***REMOVED***
	if(!str) return "";
	return `/* $***REMOVED***str***REMOVED*** */`;
***REMOVED***
