/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
"use strict";

const ConcatSource = require("webpack-sources").ConcatSource;

class JsonpChunkTemplatePlugin ***REMOVED***
	apply(chunkTemplate) ***REMOVED***
		chunkTemplate.plugin("render", function(modules, chunk) ***REMOVED***
			const jsonpFunction = this.outputOptions.jsonpFunction;
			const source = new ConcatSource();
			source.add(`$***REMOVED***jsonpFunction***REMOVED***($***REMOVED***JSON.stringify(chunk.ids)***REMOVED***,`);
			source.add(modules);
			const entries = [chunk.entryModule].filter(Boolean).map(m => m.id);
			if(entries.length > 0) ***REMOVED***
				source.add(`,$***REMOVED***JSON.stringify(entries)***REMOVED***`);
			***REMOVED***
			source.add(")");
			return source;
		***REMOVED***);
		chunkTemplate.plugin("hash", function(hash) ***REMOVED***
			hash.update("JsonpChunkTemplatePlugin");
			hash.update("3");
			hash.update(`$***REMOVED***this.outputOptions.jsonpFunction***REMOVED***`);
			hash.update(`$***REMOVED***this.outputOptions.library***REMOVED***`);
		***REMOVED***);
	***REMOVED***
***REMOVED***
module.exports = JsonpChunkTemplatePlugin;
