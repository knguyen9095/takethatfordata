/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
"use strict";

const ConcatSource = require("webpack-sources").ConcatSource;

function accessorToObjectAccess(accessor) ***REMOVED***
	return accessor.map(a => `[$***REMOVED***JSON.stringify(a)***REMOVED***]`).join("");
***REMOVED***

class ExportPropertyMainTemplatePlugin ***REMOVED***
	constructor(property) ***REMOVED***
		this.property = property;
	***REMOVED***

	apply(compilation) ***REMOVED***
		const mainTemplate = compilation.mainTemplate;
		compilation.templatesPlugin("render-with-entry", (source, chunk, hash) => ***REMOVED***
			const postfix = `$***REMOVED***accessorToObjectAccess([].concat(this.property))***REMOVED***`;
			return new ConcatSource(source, postfix);
		***REMOVED***);
		mainTemplate.plugin("hash", hash => ***REMOVED***
			hash.update("export property");
			hash.update(`$***REMOVED***this.property***REMOVED***`);
		***REMOVED***);
	***REMOVED***
***REMOVED***

module.exports = ExportPropertyMainTemplatePlugin;
