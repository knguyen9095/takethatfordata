'use strict';

function preserveCamelCase(str) ***REMOVED***
	let isLastCharLower = false;
	let isLastCharUpper = false;
	let isLastLastCharUpper = false;

	for (let i = 0; i < str.length; i++) ***REMOVED***
		const c = str[i];

		if (isLastCharLower && /[a-zA-Z]/.test(c) && c.toUpperCase() === c) ***REMOVED***
			str = str.substr(0, i) + '-' + str.substr(i);
			isLastCharLower = false;
			isLastLastCharUpper = isLastCharUpper;
			isLastCharUpper = true;
			i++;
		***REMOVED*** else if (isLastCharUpper && isLastLastCharUpper && /[a-zA-Z]/.test(c) && c.toLowerCase() === c) ***REMOVED***
			str = str.substr(0, i - 1) + '-' + str.substr(i - 1);
			isLastLastCharUpper = isLastCharUpper;
			isLastCharUpper = false;
			isLastCharLower = true;
		***REMOVED*** else ***REMOVED***
			isLastCharLower = c.toLowerCase() === c;
			isLastLastCharUpper = isLastCharUpper;
			isLastCharUpper = c.toUpperCase() === c;
		***REMOVED***
	***REMOVED***

	return str;
***REMOVED***

module.exports = function (str) ***REMOVED***
	if (arguments.length > 1) ***REMOVED***
		str = Array.from(arguments)
			.map(x => x.trim())
			.filter(x => x.length)
			.join('-');
	***REMOVED*** else ***REMOVED***
		str = str.trim();
	***REMOVED***

	if (str.length === 0) ***REMOVED***
		return '';
	***REMOVED***

	if (str.length === 1) ***REMOVED***
		return str.toLowerCase();
	***REMOVED***

	if (/^[a-z0-9]+$/.test(str)) ***REMOVED***
		return str;
	***REMOVED***

	const hasUpperCase = str !== str.toLowerCase();

	if (hasUpperCase) ***REMOVED***
		str = preserveCamelCase(str);
	***REMOVED***

	return str
		.replace(/^[_.\- ]+/, '')
		.toLowerCase()
		.replace(/[_.\- ]+(\w|$)/g, (m, p1) => p1.toUpperCase());
***REMOVED***;
