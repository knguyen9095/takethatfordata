// Stack grow safe implementation

"use strict";

var ensureValue       = require("../../object/valid-value")
  , isArray           = Array.isArray
  , objHasOwnProperty = Object.prototype.hasOwnProperty;

module.exports = function () ***REMOVED***
	var input = ensureValue(this), index = 0, remaining, remainingIndexes, length, i, result = [];
	// Jslint: ignore
	main: while (input) ***REMOVED***
		length = input.length;
		for (i = index; i < length; ++i) ***REMOVED***
			if (!objHasOwnProperty.call(input, i)) continue;
			if (isArray(input[i])) ***REMOVED***
				if (i < length - 1) ***REMOVED***
					// eslint-disable-next-line max-depth
					if (!remaining) ***REMOVED***
						remaining = [];
						remainingIndexes = [];
					***REMOVED***
					remaining.push(input);
					remainingIndexes.push(i + 1);
				***REMOVED***
				input = input[i];
				index = 0;
				continue main;
			***REMOVED***
			result.push(input[i]);
		***REMOVED***
		if (remaining) ***REMOVED***
			input = remaining.pop();
			index = remainingIndexes.pop();
		***REMOVED*** else ***REMOVED***
			input = null;
		***REMOVED***
	***REMOVED***
	return result;
***REMOVED***;
