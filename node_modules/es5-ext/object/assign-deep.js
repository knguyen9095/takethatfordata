"use strict";

var includes      = require("../array/#/contains")
  , uniq          = require("../array/#/uniq")
  , objForEach    = require("./for-each")
  , isPlainObject = require("./is-plain-object")
  , ensureValue   = require("./valid-value");

var isArray = Array.isArray, slice = Array.prototype.slice;

var deepAssign = function (target, source) ***REMOVED***
	if (isPlainObject(target)) ***REMOVED***
		if (!isPlainObject(source)) return source;
		objForEach(source, function (value, key) ***REMOVED***
			target[key] = deepAssign(target[key], value);
		***REMOVED***);
		return target;
	***REMOVED***
	if (isArray(target)) ***REMOVED***
		if (!isArray(source)) return source;
		source.forEach(function (item) ***REMOVED***
			if (!includes.call(target, item)) target.push(item);
		***REMOVED***);
		return target;
	***REMOVED***
	return source;
***REMOVED***;

module.exports = function (target /*, ...objects*/) ***REMOVED***
	return uniq
		.call([ensureValue(target)].concat(slice.call(arguments, 1).map(ensureValue)))
		.reduce(deepAssign);
***REMOVED***;
