// Workaround for http://code.google.com/p/v8/issues/detail?id=2804

"use strict";

var create = Object.create, shim;

if (!require("./set-prototype-of/is-implemented")()) ***REMOVED***
	shim = require("./set-prototype-of/shim");
***REMOVED***

module.exports = (function () ***REMOVED***
	var nullObject, polyProps, desc;
	if (!shim) return create;
	if (shim.level !== 1) return create;

	nullObject = ***REMOVED******REMOVED***;
	polyProps = ***REMOVED******REMOVED***;
	desc = ***REMOVED***
		configurable: false,
		enumerable: false,
		writable: true,
		value: undefined
	***REMOVED***;
	Object.getOwnPropertyNames(Object.prototype).forEach(function (name) ***REMOVED***
		if (name === "__proto__") ***REMOVED***
			polyProps[name] = ***REMOVED***
				configurable: true,
				enumerable: false,
				writable: true,
				value: undefined
			***REMOVED***;
			return;
		***REMOVED***
		polyProps[name] = desc;
	***REMOVED***);
	Object.defineProperties(nullObject, polyProps);

	Object.defineProperty(shim, "nullPolyfill", ***REMOVED***
		configurable: false,
		enumerable: false,
		writable: false,
		value: nullObject
	***REMOVED***);

	return function (prototype, props) ***REMOVED***
		return create(prototype === null ? nullObject : prototype, props);
	***REMOVED***;
***REMOVED***());
