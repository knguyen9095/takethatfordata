/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
"use strict";

const SourceNode = require("source-map").SourceNode;
const SourceListMap = require("source-list-map").SourceListMap;
const Source = require("./Source");

class ConcatSource extends Source ***REMOVED***
	constructor() ***REMOVED***
		super();
		this.children = [];
		for(var i = 0; i < arguments.length; i++) ***REMOVED***
			var item = arguments[i];
			if(item instanceof ConcatSource) ***REMOVED***
				var children = item.children;
				for(var j = 0; j < children.length; j++)
					this.children.push(children[j]);
			***REMOVED*** else ***REMOVED***
				this.children.push(item);
			***REMOVED***
		***REMOVED***
	***REMOVED***

	add(item) ***REMOVED***
		if(item instanceof ConcatSource) ***REMOVED***
			var children = item.children;
			for(var j = 0; j < children.length; j++)
				this.children.push(children[j]);
		***REMOVED*** else ***REMOVED***
			this.children.push(item);
		***REMOVED***
	***REMOVED***

	source() ***REMOVED***
		let source = "";
		const children = this.children;
		for(let i = 0; i < children.length; i++) ***REMOVED***
			const child = children[i];
			source += typeof child === "string" ? child : child.source();
		***REMOVED***
		return source;
	***REMOVED***

	size() ***REMOVED***
		let size = 0;
		const children = this.children;
		for(let i = 0; i < children.length; i++) ***REMOVED***
			const child = children[i];
			size += typeof child === "string" ? child.length : child.size();
		***REMOVED***
		return size;
	***REMOVED***

	node(options) ***REMOVED***
		const node = new SourceNode(null, null, null, this.children.map(function(item) ***REMOVED***
			return typeof item === "string" ? item : item.node(options);
		***REMOVED***));
		return node;
	***REMOVED***

	listMap(options) ***REMOVED***
		const map = new SourceListMap();
		var children = this.children;
		for(var i = 0; i < children.length; i++) ***REMOVED***
			var item = children[i];
			if(typeof item === "string")
				map.add(item);
			else
				map.add(item.listMap(options));
		***REMOVED***
		return map;
	***REMOVED***

	updateHash(hash) ***REMOVED***
		var children = this.children;
		for(var i = 0; i < children.length; i++) ***REMOVED***
			var item = children[i];
			if(typeof item === "string")
				hash.update(item);
			else
				item.updateHash(hash);
		***REMOVED***
	***REMOVED***
***REMOVED***

require("./SourceAndMapMixin")(ConcatSource.prototype);

module.exports = ConcatSource;
