/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
"use strict";

var SourceNode = require("source-map").SourceNode;
var SourceMapConsumer = require("source-map").SourceMapConsumer;
var SourceListMap = require("source-list-map").SourceListMap;
var Source = require("./Source");

class LineToLineMappedSource extends Source ***REMOVED***
	constructor(value, name, originalSource) ***REMOVED***
		super();
		this._value = value;
		this._name = name;
		this._originalSource = originalSource;
	***REMOVED***

	source() ***REMOVED***
		return this._value;
	***REMOVED***

	node(options) ***REMOVED***
		var value = this._value;
		var name = this._name;
		var lines = value.split("\n");
		var node = new SourceNode(null, null, null,
			lines.map(function(line, idx) ***REMOVED***
				return new SourceNode(idx + 1, 0, name, (line + (idx != lines.length - 1 ? "\n" : "")));
			***REMOVED***)
		);
		node.setSourceContent(name, this._originalSource);
		return node;
	***REMOVED***

	listMap(options) ***REMOVED***
		return new SourceListMap(this._value, this._name, this._originalSource)
	***REMOVED***

	updateHash(hash) ***REMOVED***
		hash.update(this._value);
		hash.update(this._originalSource);
	***REMOVED***
***REMOVED***

require("./SourceAndMapMixin")(LineToLineMappedSource.prototype);

module.exports = LineToLineMappedSource;
