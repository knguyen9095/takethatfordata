//? if (BASE64) ***REMOVED***
//? if (!NODE) ***REMOVED***
// lxiv-embeddable

//? include("../../node_modules/lxiv/dist/lxiv-embeddable.js");

//? ***REMOVED***
// encodings/base64

/**
 * Encodes this ByteBuffer's contents to a base64 encoded string.
 * @param ***REMOVED***number=***REMOVED*** begin Offset to begin at, defaults to ***REMOVED***@link ByteBuffer#offset***REMOVED***.
 * @param ***REMOVED***number=***REMOVED*** end Offset to end at, defaults to ***REMOVED***@link ByteBuffer#limit***REMOVED***.
 * @returns ***REMOVED***string***REMOVED*** Base64 encoded string
 * @throws ***REMOVED***RangeError***REMOVED*** If `begin` or `end` is out of bounds
 * @expose
 */
ByteBufferPrototype.toBase64 = function(begin, end) ***REMOVED***
    if (typeof begin === 'undefined')
        begin = this.offset;
    if (typeof end === 'undefined')
        end = this.limit;
    begin = begin | 0; end = end | 0;
    if (begin < 0 || end > this.capacity || begin > end)
        throw RangeError("begin, end");
    //? if (NODE)
    return this.buffer.toString("base64", begin, end);
    //? else ***REMOVED***
    var sd; lxiv.encode(function() ***REMOVED***
        //? if (DATAVIEW)
        return begin < end ? this.view.getUint8(begin++) : null;
        //? else
        return begin < end ? this.view[begin++] : null;
    ***REMOVED***.bind(this), sd = stringDestination());
    return sd();
    //? ***REMOVED***
***REMOVED***;

/**
 * Decodes a base64 encoded string to a ByteBuffer.
 * @param ***REMOVED***string***REMOVED*** str String to decode
 * @param ***REMOVED***boolean=***REMOVED*** littleEndian Whether to use little or big endian byte order. Defaults to
 *  ***REMOVED***@link ByteBuffer.DEFAULT_ENDIAN***REMOVED***.
 * @returns ***REMOVED***!ByteBuffer***REMOVED*** ByteBuffer
 * @expose
 */
ByteBuffer.fromBase64 = function(str, littleEndian) ***REMOVED***
    //? if (NODE) ***REMOVED***
    return ByteBuffer.wrap(new Buffer(str, "base64"), littleEndian);
    //? ***REMOVED*** else ***REMOVED***
    if (typeof str !== 'string')
        throw TypeError("str");
    var bb = new ByteBuffer(str.length/4*3, littleEndian),
        i = 0;
    lxiv.decode(stringSource(str), function(b) ***REMOVED***
        //? if (DATAVIEW)
        bb.view.setUint8(i++, b);
        //? else
        bb.view[i++] = b;
    ***REMOVED***);
    bb.limit = i;
    //? ***REMOVED***
    return bb;
***REMOVED***;

/**
 * Encodes a binary string to base64 like `window.btoa` does.
 * @param ***REMOVED***string***REMOVED*** str Binary string
 * @returns ***REMOVED***string***REMOVED*** Base64 encoded string
 * @see https://developer.mozilla.org/en-US/docs/Web/API/Window.btoa
 * @expose
 */
ByteBuffer.btoa = function(str) ***REMOVED***
    return ByteBuffer.fromBinary(str).toBase64();
***REMOVED***;

/**
 * Decodes a base64 encoded string to binary like `window.atob` does.
 * @param ***REMOVED***string***REMOVED*** b64 Base64 encoded string
 * @returns ***REMOVED***string***REMOVED*** Binary string
 * @see https://developer.mozilla.org/en-US/docs/Web/API/Window.atob
 * @expose
 */
ByteBuffer.atob = function(b64) ***REMOVED***
    return ByteBuffer.fromBase64(b64).toBinary();
***REMOVED***;

//? ***REMOVED***