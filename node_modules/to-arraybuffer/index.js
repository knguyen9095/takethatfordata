var Buffer = require('buffer').Buffer

module.exports = function (buf) ***REMOVED***
	// If the buffer is backed by a Uint8Array, a faster version will work
	if (buf instanceof Uint8Array) ***REMOVED***
		// If the buffer isn't a subarray, return the underlying ArrayBuffer
		if (buf.byteOffset === 0 && buf.byteLength === buf.buffer.byteLength) ***REMOVED***
			return buf.buffer
		***REMOVED*** else if (typeof buf.buffer.slice === 'function') ***REMOVED***
			// Otherwise we need to get a proper copy
			return buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength)
		***REMOVED***
	***REMOVED***

	if (Buffer.isBuffer(buf)) ***REMOVED***
		// This is the slow version that will work with any Buffer
		// implementation (even in old browsers)
		var arrayCopy = new Uint8Array(buf.length)
		var len = buf.length
		for (var i = 0; i < len; i++) ***REMOVED***
			arrayCopy[i] = buf[i]
		***REMOVED***
		return arrayCopy.buffer
	***REMOVED*** else ***REMOVED***
		throw new Error('Argument must be a Buffer')
	***REMOVED***
***REMOVED***
