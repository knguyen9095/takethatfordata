var test = require('tape');
var traverse = require('../');

test('json test', function (t) ***REMOVED***
    var id = 54;
    var callbacks = ***REMOVED******REMOVED***;
    var obj = ***REMOVED*** moo : function () ***REMOVED******REMOVED***, foo : [2,3,4, function () ***REMOVED******REMOVED***] ***REMOVED***;
    
    var scrubbed = traverse(obj).map(function (x) ***REMOVED***
        if (typeof x === 'function') ***REMOVED***
            callbacks[id] = ***REMOVED*** id : id, f : x, path : this.path ***REMOVED***;
            this.update('[Function]');
            id++;
        ***REMOVED***
    ***REMOVED***);
    
    t.equal(
        scrubbed.moo, '[Function]',
        'obj.moo replaced with "[Function]"'
    );
    
    t.equal(
        scrubbed.foo[3], '[Function]',
        'obj.foo[3] replaced with "[Function]"'
    );
    
    t.same(scrubbed, ***REMOVED***
        moo : '[Function]',
        foo : [ 2, 3, 4, "[Function]" ]
    ***REMOVED***, 'Full JSON string matches');
    
    t.same(
        typeof obj.moo, 'function',
        'Original obj.moo still a function'
    );
    
    t.same(
        typeof obj.foo[3], 'function',
        'Original obj.foo[3] still a function'
    );
    
    t.same(callbacks, ***REMOVED***
        54: ***REMOVED*** id: 54, f : obj.moo, path: [ 'moo' ] ***REMOVED***,
        55: ***REMOVED*** id: 55, f : obj.foo[3], path: [ 'foo', '3' ] ***REMOVED***,
    ***REMOVED***, 'Check the generated callbacks list');
    
    t.end();
***REMOVED***);

