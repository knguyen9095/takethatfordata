#!/usr/bin/env node
var traverse = require('traverse');

var obj = [ 'five', 6, -3, [ 7, 8, -2, 1 ], ***REMOVED*** f : 10, g : -13 ***REMOVED*** ];

var s = '';
traverse(obj).forEach(function to_s (node) ***REMOVED***
    if (Array.isArray(node)) ***REMOVED***
        this.before(function () ***REMOVED*** s += '[' ***REMOVED***);
        this.post(function (child) ***REMOVED***
            if (!child.isLast) s += ',';
        ***REMOVED***);
        this.after(function () ***REMOVED*** s += ']' ***REMOVED***);
    ***REMOVED***
    else if (typeof node == 'object') ***REMOVED***
        this.before(function () ***REMOVED*** s += '***REMOVED***' ***REMOVED***);
        this.pre(function (x, key) ***REMOVED***
            to_s(key);
            s += ':';
        ***REMOVED***);
        this.post(function (child) ***REMOVED***
            if (!child.isLast) s += ',';
        ***REMOVED***);
        this.after(function () ***REMOVED*** s += '***REMOVED***' ***REMOVED***);
    ***REMOVED***
    else if (typeof node == 'string') ***REMOVED***
        s += '"' + node.toString().replace(/"/g, '\\"') + '"';
    ***REMOVED***
    else if (typeof node == 'function') ***REMOVED***
        s += 'null';
    ***REMOVED***
    else ***REMOVED***
        s += node.toString();
    ***REMOVED***
***REMOVED***);

console.log('JSON.stringify: ' + JSON.stringify(obj));
console.log('this stringify: ' + s);
