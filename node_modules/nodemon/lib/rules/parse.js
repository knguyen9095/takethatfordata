'use strict';
var fs = require('fs');

/**
 * Parse the nodemon config file, supporting both old style
 * plain text config file, and JSON version of the config
 *
 * @param  ***REMOVED***String***REMOVED***   filename
 * @param  ***REMOVED***Function***REMOVED*** callback
 */
function parse(filename, callback) ***REMOVED***
  var rules = ***REMOVED***
    ignore: [],
    watch: [],
  ***REMOVED***;

  fs.readFile(filename, 'utf8', function (err, content) ***REMOVED***

    if (err) ***REMOVED***
      return callback(err);
    ***REMOVED***

    var json = null;
    try ***REMOVED***
      json = JSON.parse(content);
    ***REMOVED*** catch (e) ***REMOVED******REMOVED***

    if (json !== null) ***REMOVED***
      rules = ***REMOVED***
        ignore: json.ignore || [],
        watch: json.watch || [],
      ***REMOVED***;

      return callback(null, rules);
    ***REMOVED***

    // otherwise return the raw file
    return callback(null, ***REMOVED*** raw: content.split(/\n/) ***REMOVED***);
  ***REMOVED***);
***REMOVED***

module.exports = parse;

