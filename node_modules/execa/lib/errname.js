'use strict';
// The Node team wants to deprecate `process.bind(...)`.
//   https://github.com/nodejs/node/pull/2768
//
// However, we need the 'uv' binding for errname support.
// This is a defensive wrapper around it so `execa` will not fail entirely if it stops working someday.
//
// If this ever stops working. See: https://github.com/sindresorhus/execa/issues/31#issuecomment-215939939 for another possible solution.
let uv;

try ***REMOVED***
	uv = process.binding('uv');

	if (typeof uv.errname !== 'function') ***REMOVED***
		throw new TypeError('uv.errname is not a function');
	***REMOVED***
***REMOVED*** catch (err) ***REMOVED***
	console.error('execa/lib/errname: unable to establish process.binding(\'uv\')', err);
	uv = null;
***REMOVED***

function errname(uv, code) ***REMOVED***
	if (uv) ***REMOVED***
		return uv.errname(code);
	***REMOVED***

	if (!(code < 0)) ***REMOVED***
		throw new Error('err >= 0');
	***REMOVED***

	return `Unknown system error $***REMOVED***code***REMOVED***`;
***REMOVED***

module.exports = code => errname(uv, code);

// Used for testing the fallback behavior
module.exports.__test__ = errname;
