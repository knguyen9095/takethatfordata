const exec = require('child_process').exec;
const psTree = require('ps-tree');
const utils = require('./utils');
var hasPS = true;

// discover if the OS has `ps`, and therefore can use psTree
exec('ps', error => ***REMOVED***
  module.exports.hasPS = hasPS = !error;
***REMOVED***);

module.exports = function main(pid, callback) ***REMOVED***
  if (typeof pid === 'number') ***REMOVED***
    pid = pid.toString();
  ***REMOVED***

  if (hasPS && !process.env.NO_PS) ***REMOVED***
    return psTree(pid, callback);
  ***REMOVED***

  utils
    .getStat()
    .then(utils.tree)
    .then(tree => utils.pidsForTree(tree, pid))
    .then(res => callback(null, res))
    .catch(error => callback(error));
***REMOVED***;

module.exports.hasPS = hasPS;
