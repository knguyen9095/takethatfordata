var es = require('event-stream')
var combine = require('..')
var test = require('tape')

test('do not duplicate errors', function (test) ***REMOVED***

  var errors = 0;
  var pipe = combine(
    es.through(function(data) ***REMOVED***
      return this.emit('data', data);
    ***REMOVED***),
    es.through(function(data) ***REMOVED***
      return this.emit('error', new Error(data));
    ***REMOVED***)
  )

  pipe.on('error', function(err) ***REMOVED***
    errors++
    test.ok(errors, 'expected error count')
      process.nextTick(function () ***REMOVED***
        return test.end();
      ***REMOVED***)
  ***REMOVED***)

  return pipe.write('meh');
***REMOVED***)

test('3 pipe do not duplicate errors', function (test) ***REMOVED***

  var errors = 0;
  var pipe = combine(
    es.through(function(data) ***REMOVED***
      return this.emit('data', data);
    ***REMOVED***),
    es.through(function(data) ***REMOVED***
      return this.emit('error', new Error(data));
    ***REMOVED***),
    es.through()
  )

  pipe.on('error', function(err) ***REMOVED***
    errors++
    test.ok(errors, 'expected error count')
      process.nextTick(function () ***REMOVED***
        return test.end();
      ***REMOVED***)
  ***REMOVED***)

  return pipe.write('meh');

***REMOVED***)

