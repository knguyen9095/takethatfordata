/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
function FileExistsPlugin(source, target) ***REMOVED***
	this.source = source;
	this.target = target;
***REMOVED***
module.exports = FileExistsPlugin;

FileExistsPlugin.prototype.apply = function(resolver) ***REMOVED***
	var target = this.target;
	resolver.plugin(this.source, function(request, callback) ***REMOVED***
		var fs = this.fileSystem;
		var file = request.path;
		fs.stat(file, function(err, stat) ***REMOVED***
			if(err || !stat) ***REMOVED***
				if(callback.missing) callback.missing.push(file);
				if(callback.log) callback.log(file + " doesn't exist");
				return callback();
			***REMOVED***
			if(!stat.isFile()) ***REMOVED***
				if(callback.missing) callback.missing.push(file);
				if(callback.log) callback.log(file + " is not a file");
				return callback();
			***REMOVED***
			this.doResolve(target, request, "existing file: " + file, callback, true);
		***REMOVED***.bind(this));
	***REMOVED***);
***REMOVED***;
