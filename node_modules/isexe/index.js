var fs = require('fs')
var core
if (process.platform === 'win32' || global.TESTING_WINDOWS) ***REMOVED***
  core = require('./windows.js')
***REMOVED*** else ***REMOVED***
  core = require('./mode.js')
***REMOVED***

module.exports = isexe
isexe.sync = sync

function isexe (path, options, cb) ***REMOVED***
  if (typeof options === 'function') ***REMOVED***
    cb = options
    options = ***REMOVED******REMOVED***
  ***REMOVED***

  if (!cb) ***REMOVED***
    if (typeof Promise !== 'function') ***REMOVED***
      throw new TypeError('callback not provided')
    ***REMOVED***

    return new Promise(function (resolve, reject) ***REMOVED***
      isexe(path, options || ***REMOVED******REMOVED***, function (er, is) ***REMOVED***
        if (er) ***REMOVED***
          reject(er)
        ***REMOVED*** else ***REMOVED***
          resolve(is)
        ***REMOVED***
      ***REMOVED***)
    ***REMOVED***)
  ***REMOVED***

  core(path, options || ***REMOVED******REMOVED***, function (er, is) ***REMOVED***
    // ignore EACCES because that just means we aren't allowed to run it
    if (er) ***REMOVED***
      if (er.code === 'EACCES' || options && options.ignoreErrors) ***REMOVED***
        er = null
        is = false
      ***REMOVED***
    ***REMOVED***
    cb(er, is)
  ***REMOVED***)
***REMOVED***

function sync (path, options) ***REMOVED***
  // my kingdom for a filtered catch
  try ***REMOVED***
    return core.sync(path, options || ***REMOVED******REMOVED***)
  ***REMOVED*** catch (er) ***REMOVED***
    if (options && options.ignoreErrors || er.code === 'EACCES') ***REMOVED***
      return false
    ***REMOVED*** else ***REMOVED***
      throw er
    ***REMOVED***
  ***REMOVED***
***REMOVED***
