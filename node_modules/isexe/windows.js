module.exports = isexe
isexe.sync = sync

var fs = require('fs')

function checkPathExt (path, options) ***REMOVED***
  var pathext = options.pathExt !== undefined ?
    options.pathExt : process.env.PATHEXT

  if (!pathext) ***REMOVED***
    return true
  ***REMOVED***

  pathext = pathext.split(';')
  if (pathext.indexOf('') !== -1) ***REMOVED***
    return true
  ***REMOVED***
  for (var i = 0; i < pathext.length; i++) ***REMOVED***
    var p = pathext[i].toLowerCase()
    if (p && path.substr(-p.length).toLowerCase() === p) ***REMOVED***
      return true
    ***REMOVED***
  ***REMOVED***
  return false
***REMOVED***

function checkStat (stat, path, options) ***REMOVED***
  if (!stat.isSymbolicLink() && !stat.isFile()) ***REMOVED***
    return false
  ***REMOVED***
  return checkPathExt(path, options)
***REMOVED***

function isexe (path, options, cb) ***REMOVED***
  fs.stat(path, function (er, stat) ***REMOVED***
    cb(er, er ? false : checkStat(stat, path, options))
  ***REMOVED***)
***REMOVED***

function sync (path, options) ***REMOVED***
  return checkStat(fs.statSync(path), path, options)
***REMOVED***
