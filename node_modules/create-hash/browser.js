'use strict'
var inherits = require('inherits')
var md5 = require('./md5')
var RIPEMD160 = require('ripemd160')
var sha = require('sha.js')

var Base = require('cipher-base')

function HashNoConstructor (hash) ***REMOVED***
  Base.call(this, 'digest')

  this._hash = hash
  this.buffers = []
***REMOVED***

inherits(HashNoConstructor, Base)

HashNoConstructor.prototype._update = function (data) ***REMOVED***
  this.buffers.push(data)
***REMOVED***

HashNoConstructor.prototype._final = function () ***REMOVED***
  var buf = Buffer.concat(this.buffers)
  var r = this._hash(buf)
  this.buffers = null

  return r
***REMOVED***

function Hash (hash) ***REMOVED***
  Base.call(this, 'digest')

  this._hash = hash
***REMOVED***

inherits(Hash, Base)

Hash.prototype._update = function (data) ***REMOVED***
  this._hash.update(data)
***REMOVED***

Hash.prototype._final = function () ***REMOVED***
  return this._hash.digest()
***REMOVED***

module.exports = function createHash (alg) ***REMOVED***
  alg = alg.toLowerCase()
  if (alg === 'md5') return new HashNoConstructor(md5)
  if (alg === 'rmd160' || alg === 'ripemd160') return new Hash(new RIPEMD160())

  return new Hash(sha(alg))
***REMOVED***
