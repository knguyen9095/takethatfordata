var extsprintf = require('extsprintf');
var fs = require('fs');
var verror = require('../lib/verror');

function checkFile(filename, callback) ***REMOVED***
	fs.stat(filename, function (err) ***REMOVED***
		if (err)
			/* Annotate the "stat" error with what we were doing. */
			return (callback(new verror.VError(err,
			    'failed to check "%s"', filename)));

		/* ... */
		return (callback());
	***REMOVED***);
***REMOVED***

function handleRequest(filename, callback) ***REMOVED***
	checkFile('/nonexistent', function (err) ***REMOVED***
		if (err)
			/* Annotate the "checkFile" error. */
			return (callback(new verror.VError(
			    err, 'request failed')));

		/* ... */
		return (callback());
	***REMOVED***);
***REMOVED***

handleRequest('/nonexistent', function (err) ***REMOVED***
	if (err) ***REMOVED***
		console.log(err.message);
		console.log(extsprintf.sprintf('%r', err));
	***REMOVED***

    /* ... */
***REMOVED***);
