var jws = require('jws');

module.exports = function (jwt, options) ***REMOVED***
  options = options || ***REMOVED******REMOVED***;
  var decoded = jws.decode(jwt, options);
  if (!decoded) ***REMOVED*** return null; ***REMOVED***
  var payload = decoded.payload;

  //try parse the payload
  if(typeof payload === 'string') ***REMOVED***
    try ***REMOVED***
      var obj = JSON.parse(payload);
      if(typeof obj === 'object') ***REMOVED***
        payload = obj;
      ***REMOVED***
    ***REMOVED*** catch (e) ***REMOVED*** ***REMOVED***
  ***REMOVED***

  //return header if `complete` option is enabled.  header includes claims
  //such as `kid` and `alg` used to select the key within a JWKS needed to
  //verify the signature
  if (options.complete === true) ***REMOVED***
    return ***REMOVED***
      header: decoded.header,
      payload: payload,
      signature: decoded.signature
    ***REMOVED***;
  ***REMOVED***
  return payload;
***REMOVED***;
