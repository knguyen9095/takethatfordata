var CipherBase = require('cipher-base')
var des = require('des.js')
var inherits = require('inherits')

var modes = ***REMOVED***
  'des-ede3-cbc': des.CBC.instantiate(des.EDE),
  'des-ede3': des.EDE,
  'des-ede-cbc': des.CBC.instantiate(des.EDE),
  'des-ede': des.EDE,
  'des-cbc': des.CBC.instantiate(des.DES),
  'des-ecb': des.DES
***REMOVED***
modes.des = modes['des-cbc']
modes.des3 = modes['des-ede3-cbc']
module.exports = DES
inherits(DES, CipherBase)
function DES (opts) ***REMOVED***
  CipherBase.call(this)
  var modeName = opts.mode.toLowerCase()
  var mode = modes[modeName]
  var type
  if (opts.decrypt) ***REMOVED***
    type = 'decrypt'
  ***REMOVED*** else ***REMOVED***
    type = 'encrypt'
  ***REMOVED***
  var key = opts.key
  if (modeName === 'des-ede' || modeName === 'des-ede-cbc') ***REMOVED***
    key = Buffer.concat([key, key.slice(0, 8)])
  ***REMOVED***
  var iv = opts.iv
  this._des = mode.create(***REMOVED***
    key: key,
    iv: iv,
    type: type
  ***REMOVED***)
***REMOVED***
DES.prototype._update = function (data) ***REMOVED***
  return new Buffer(this._des.update(data))
***REMOVED***
DES.prototype._final = function () ***REMOVED***
  return new Buffer(this._des.final())
***REMOVED***
