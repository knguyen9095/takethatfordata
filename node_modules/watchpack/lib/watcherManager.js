/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
var path = require("path");

function WatcherManager() ***REMOVED***
	this.directoryWatchers = ***REMOVED******REMOVED***;
***REMOVED***

WatcherManager.prototype.getDirectoryWatcher = function(directory, options) ***REMOVED***
	var DirectoryWatcher = require("./DirectoryWatcher");
	options = options || ***REMOVED******REMOVED***;
	var key = directory + " " + JSON.stringify(options);
	if(!this.directoryWatchers[key]) ***REMOVED***
		this.directoryWatchers[key] = new DirectoryWatcher(directory, options);
		this.directoryWatchers[key].on("closed", function() ***REMOVED***
			delete this.directoryWatchers[key];
		***REMOVED***.bind(this));
	***REMOVED***
	return this.directoryWatchers[key];
***REMOVED***;

WatcherManager.prototype.watchFile = function watchFile(p, options, startTime) ***REMOVED***
	var directory = path.dirname(p);
	return this.getDirectoryWatcher(directory, options).watch(p, startTime);
***REMOVED***;

WatcherManager.prototype.watchDirectory = function watchDirectory(directory, options, startTime) ***REMOVED***
	return this.getDirectoryWatcher(directory, options).watch(directory, startTime);
***REMOVED***;

module.exports = new WatcherManager();
