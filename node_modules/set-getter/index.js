/*!
 * set-getter (https://github.com/doowb/set-getter)
 *
 * Copyright (c) 2016, Brian Woodward.
 * Licensed under the MIT License.
 */

'use strict';

var toPath = require('to-object-path');

/**
 * Defines a getter function on an object using property path notation.
 *
 * ```js
 * var obj = ***REMOVED******REMOVED***;
 * getter(obj, 'foo', function() ***REMOVED***
 *   return 'bar';
 * ***REMOVED***);
 * ```
 * @param ***REMOVED***Object***REMOVED*** `obj` Object to add property to.
 * @param ***REMOVED***String|Array***REMOVED*** `prop` Property string or array to add.
 * @param ***REMOVED***Function***REMOVED*** `getter` Getter function to add as a property.
 * @api public
 */

function setGetter(obj, prop, getter) ***REMOVED***
  var key = toPath(arguments);
  return define(obj, key, getter);
***REMOVED***

/**
 * Define getter function on object or object hierarchy using dot notation.
 *
 * @param  ***REMOVED***Object***REMOVED*** `obj` Object to define getter property on.
 * @param  ***REMOVED***String***REMOVED*** `prop` Property string to define.
 * @param  ***REMOVED***Function***REMOVED*** `getter` Getter function to define.
 * @return ***REMOVED***Object***REMOVED*** Returns original object.
 */

function define(obj, prop, getter) ***REMOVED***
  if (!~prop.indexOf('.')) ***REMOVED***
    defineProperty(obj, prop, getter);
    return obj;
  ***REMOVED***

  var keys = prop.split('.');
  var last = keys.pop();
  var target = obj;
  var key;

  while ((key = keys.shift())) ***REMOVED***
    while (key.slice(-1) === '\\') ***REMOVED***
      key = key.slice(0, -1) + '.' + keys.shift();
    ***REMOVED***
    target = target[key] || (target[key] = ***REMOVED******REMOVED***);
  ***REMOVED***

  defineProperty(target, last, getter);
  return obj;
***REMOVED***

/**
 * Define getter function on object as a configurable and enumerable property.
 *
 * @param  ***REMOVED***Object***REMOVED*** `obj` Object to define property on.
 * @param  ***REMOVED***String***REMOVED*** `prop` Property to define.
 * @param  ***REMOVED***Function***REMOVED*** `getter` Getter function to define.
 */

function defineProperty(obj, prop, getter) ***REMOVED***
  Object.defineProperty(obj, prop, ***REMOVED***
    configurable: true,
    enumerable: true,
    get: getter
  ***REMOVED***);
***REMOVED***

/**
 * Expose `setGetter`
 */

module.exports = setGetter;
