var assert = require('assert');
var fs = require('fs');

describe('GoogleP12Pem', function() ***REMOVED***
  var gp12pem = require('../index.js');
  var GOODP12FILE = './test/assets/key.p12';
  var BADP12FILE = './test/assets/badkey.p12';
  var PEMFILENAME = './test/assets/key.pem';
  var expectedPem = fs.readFileSync(PEMFILENAME, ***REMOVED*** encoding: 'utf8' ***REMOVED***);
  var noop = function() ***REMOVED******REMOVED***;

  it('should exist', function() ***REMOVED***
    assert.equal(typeof gp12pem, 'function');
  ***REMOVED***);

  it('should provide error on bad filename and callback', function(done) ***REMOVED***
    gp12pem('./badfilename.p12', function(err, pem) ***REMOVED***
      assert(err);
      assert.equal(pem, null);
      assert.ok(err.message.startsWith("ENOENT"));
      done();
    ***REMOVED***);
  ***REMOVED***);

  it('should throw ENOENT on bad filename with no callback', function() ***REMOVED***
    assert.throws(function() ***REMOVED***
      var pem = gp12pem('./badfilename.p12');
    ***REMOVED***, /ENOENT/);
  ***REMOVED***);

  it('should throw error on bad .p12 with no callback', function() ***REMOVED***
    assert.throws(function() ***REMOVED***
      var pem = gp12pem(BADP12FILE);
    ***REMOVED***, /Too few bytes to read/);
  ***REMOVED***);

  it('should return error on bad .p12 in callback', function(done) ***REMOVED***
    assert.doesNotThrow(function() ***REMOVED***
      gp12pem(BADP12FILE, function(err, pem) ***REMOVED***
        assert.equal(null);
        assert(err.message.indexOf('Too few bytes to read') > -1);
        done();
      ***REMOVED***);
    ***REMOVED***);
  ***REMOVED***);

  it('should work async when provided a callback', function(done) ***REMOVED***
    gp12pem(GOODP12FILE, function(err, pem) ***REMOVED***
      assert.ifError(err);
      assert.equal(expectedPem, pem);
      done();
    ***REMOVED***);
  ***REMOVED***);

  it('should work sync when not provided a callback', function() ***REMOVED***
    var pem = gp12pem(GOODP12FILE);
    assert.equal(expectedPem, pem);
  ***REMOVED***);
***REMOVED***);
