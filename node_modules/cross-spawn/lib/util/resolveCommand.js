'use strict';

var path = require('path');
var which = require('which');
var LRU = require('lru-cache');

var commandCache = new LRU(***REMOVED*** max: 50, maxAge: 30 * 1000 ***REMOVED***);  // Cache just for 30sec

function resolveCommand(command, noExtension) ***REMOVED***
    var resolved;

    noExtension = !!noExtension;
    resolved = commandCache.get(command + '!' + noExtension);

    // Check if its resolved in the cache
    if (commandCache.has(command)) ***REMOVED***
        return commandCache.get(command);
    ***REMOVED***

    try ***REMOVED***
        resolved = !noExtension ?
            which.sync(command) :
            which.sync(command, ***REMOVED*** pathExt: path.delimiter + (process.env.PATHEXT || '') ***REMOVED***);
    ***REMOVED*** catch (e) ***REMOVED*** /* empty */ ***REMOVED***

    commandCache.set(command + '!' + noExtension, resolved);

    return resolved;
***REMOVED***

module.exports = resolveCommand;
