include_directories(../../include)

if ($***REMOVED***ARCH***REMOVED*** STREQUAL "x86_64")
  set(
    AES_ARCH_SOURCES

    aes-x86_64.$***REMOVED***ASM_EXT***REMOVED***
    aesni-x86_64.$***REMOVED***ASM_EXT***REMOVED***
    bsaes-x86_64.$***REMOVED***ASM_EXT***REMOVED***
    vpaes-x86_64.$***REMOVED***ASM_EXT***REMOVED***
  )
endif()

if ($***REMOVED***ARCH***REMOVED*** STREQUAL "x86")
  set(
    AES_ARCH_SOURCES

    aes-586.$***REMOVED***ASM_EXT***REMOVED***
    vpaes-x86.$***REMOVED***ASM_EXT***REMOVED***
    aesni-x86.$***REMOVED***ASM_EXT***REMOVED***
  )
endif()

if ($***REMOVED***ARCH***REMOVED*** STREQUAL "arm")
  set(
    AES_ARCH_SOURCES

    aes-armv4.$***REMOVED***ASM_EXT***REMOVED***
    bsaes-armv7.$***REMOVED***ASM_EXT***REMOVED***
    aesv8-armx.$***REMOVED***ASM_EXT***REMOVED***
  )
endif()

if ($***REMOVED***ARCH***REMOVED*** STREQUAL "aarch64")
  set(
    AES_ARCH_SOURCES

    aesv8-armx.$***REMOVED***ASM_EXT***REMOVED***
  )
endif()

if ($***REMOVED***ARCH***REMOVED*** STREQUAL "ppc64le")
  set(
    AES_ARCH_SOURCES

    aesp8-ppc.$***REMOVED***ASM_EXT***REMOVED***
  )
endif()

add_library(
  aes

  OBJECT

  aes.c
  key_wrap.c
  mode_wrappers.c

  $***REMOVED***AES_ARCH_SOURCES***REMOVED***
)

perlasm(aes-x86_64.$***REMOVED***ASM_EXT***REMOVED*** asm/aes-x86_64.pl)
perlasm(aesni-x86_64.$***REMOVED***ASM_EXT***REMOVED*** asm/aesni-x86_64.pl)
perlasm(bsaes-x86_64.$***REMOVED***ASM_EXT***REMOVED*** asm/bsaes-x86_64.pl)
perlasm(vpaes-x86_64.$***REMOVED***ASM_EXT***REMOVED*** asm/vpaes-x86_64.pl)
perlasm(aes-586.$***REMOVED***ASM_EXT***REMOVED*** asm/aes-586.pl)
perlasm(vpaes-x86.$***REMOVED***ASM_EXT***REMOVED*** asm/vpaes-x86.pl)
perlasm(aesni-x86.$***REMOVED***ASM_EXT***REMOVED*** asm/aesni-x86.pl)
perlasm(aes-armv4.$***REMOVED***ASM_EXT***REMOVED*** asm/aes-armv4.pl)
perlasm(bsaes-armv7.$***REMOVED***ASM_EXT***REMOVED*** asm/bsaes-armv7.pl)
perlasm(aesv8-armx.$***REMOVED***ASM_EXT***REMOVED*** asm/aesv8-armx.pl)
perlasm(aesp8-ppc.$***REMOVED***ASM_EXT***REMOVED*** asm/aesp8-ppc.pl)

add_executable(
  aes_test

  aes_test.cc
  $<TARGET_OBJECTS:test_support>
)

target_link_libraries(aes_test crypto)
add_dependencies(all_tests aes_test)
