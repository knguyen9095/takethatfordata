"use strict";
/**
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var __extends = (this && this.__extends) || (function () ***REMOVED***
    var extendStatics = Object.setPrototypeOf ||
        (***REMOVED*** __proto__: [] ***REMOVED*** instanceof Array && function (d, b) ***REMOVED*** d.__proto__ = b; ***REMOVED***) ||
        function (d, b) ***REMOVED*** for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; ***REMOVED***;
    return function (d, b) ***REMOVED***
        extendStatics(d, b);
        function __() ***REMOVED*** this.constructor = d; ***REMOVED***
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    ***REMOVED***;
***REMOVED***)();
Object.defineProperty(exports, "__esModule", ***REMOVED*** value: true ***REMOVED***);
var EventEmitter_1 = require("./EventEmitter");
var util_1 = require("@firebase/util");
/**
 * @extends ***REMOVED***EventEmitter***REMOVED***
 */
var VisibilityMonitor = /** @class */ (function (_super) ***REMOVED***
    __extends(VisibilityMonitor, _super);
    function VisibilityMonitor() ***REMOVED***
        var _this = _super.call(this, ['visible']) || this;
        var hidden;
        var visibilityChange;
        if (typeof document !== 'undefined' &&
            typeof document.addEventListener !== 'undefined') ***REMOVED***
            if (typeof document['hidden'] !== 'undefined') ***REMOVED***
                // Opera 12.10 and Firefox 18 and later support
                visibilityChange = 'visibilitychange';
                hidden = 'hidden';
            ***REMOVED***
            else if (typeof document['mozHidden'] !== 'undefined') ***REMOVED***
                visibilityChange = 'mozvisibilitychange';
                hidden = 'mozHidden';
            ***REMOVED***
            else if (typeof document['msHidden'] !== 'undefined') ***REMOVED***
                visibilityChange = 'msvisibilitychange';
                hidden = 'msHidden';
            ***REMOVED***
            else if (typeof document['webkitHidden'] !== 'undefined') ***REMOVED***
                visibilityChange = 'webkitvisibilitychange';
                hidden = 'webkitHidden';
            ***REMOVED***
        ***REMOVED***
        // Initially, we always assume we are visible. This ensures that in browsers
        // without page visibility support or in cases where we are never visible
        // (e.g. chrome extension), we act as if we are visible, i.e. don't delay
        // reconnects
        _this.visible_ = true;
        if (visibilityChange) ***REMOVED***
            document.addEventListener(visibilityChange, function () ***REMOVED***
                var visible = !document[hidden];
                if (visible !== _this.visible_) ***REMOVED***
                    _this.visible_ = visible;
                    _this.trigger('visible', visible);
                ***REMOVED***
            ***REMOVED***, false);
        ***REMOVED***
        return _this;
    ***REMOVED***
    VisibilityMonitor.getInstance = function () ***REMOVED***
        return new VisibilityMonitor();
    ***REMOVED***;
    /**
     * @param ***REMOVED***!string***REMOVED*** eventType
     * @return ***REMOVED***Array.<boolean>***REMOVED***
     */
    VisibilityMonitor.prototype.getInitialEvent = function (eventType) ***REMOVED***
        util_1.assert(eventType === 'visible', 'Unknown event type: ' + eventType);
        return [this.visible_];
    ***REMOVED***;
    return VisibilityMonitor;
***REMOVED***(EventEmitter_1.EventEmitter));
exports.VisibilityMonitor = VisibilityMonitor;

//# sourceMappingURL=VisibilityMonitor.js.map
